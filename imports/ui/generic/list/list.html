<template name="genericList">
	{{#unless loadComplete}}
		{{> loading}}
	{{/unless}}

	{{#if insertForm}}
		<div class="card-body d-flex justify-content-between">
			<h4>{{i18n config.label}} - {{i18n "actions.insertDoc"}}</h4>
			<button class="btn btn-sm btn-outline-secondary cancel-form-button">
				<i class="fa fa-fw fas fa-times"></i>
			</button>
		</div>

		<div class="card-body {{#if submitting}}d-unavailable{{/if}}">
			{{>quickForm id="insertForm" type="normal" schema=insertSchema}}
			{{#if submitting}}
				<span><i class="fa fas fa-fw fa-spinner fa-pulse"></i></span>
				<span>{{i18n "actions.submitting"}}</span>
			{{/if}}
		</div>
	{{else if updateForm}}
		<div class="card-body d-flex justify-content-between">
			<h4>{{i18n config.label}} - {{i18n "actions.updateDoc"}}</h4>
			<button class="btn btn-sm btn-outline-secondary cancel-form-button">
				<i class="fa fa-fw fas fa-times"></i>
			</button>
		</div>

		<div class="card-body {{#if submitting}}d-unavailable{{/if}}">
			{{>quickForm id="updateForm" type="normal" schema=updateSchema doc=updateDoc}}
			{{#if submitting}}
				<span><i class="fa fas fa-fw fa-spinner fa-pulse"></i></span>
				<span>{{i18n "actions.submitting"}}</span>
			{{/if}}
		</div>
	{{else}}
		<div class="card-body d-flex">
		<span class="no-wrap mr-auto">
			<h4>{{i18n config.label}}</h4>
			<i class="fa fa-fw fa-file"></i>
			<span>{{count}}</span>
		</span>
			{{#with actionUpload}}
				{{> upload filesCollection=uploadFilesCollection accept=this.accept class="ml-auto"}}
			{{/with}}
			{{#with actionInsert}}
				<button class="btn btn-success insert-button">
					<i class="fas fa fa-fw fa-plus"></i>
					<span>{{i18n "actions.create"}}</span>
				</button>
			{{/with}}
		</div>

		{{#with documents}}
			<div class="card-body bg-white">
				<table class="table table-striped">
					<tr>
						<th>#</th>
						{{#each label in fieldLabels}}
							<th>{{i18n label}}</th>
						{{/each}}
						<th></th>
					</tr>
					{{#each document in this}}
						<tr>
							<td class="text-muted">{{@index}}</td>
							{{#each fields document}}
								<td>{{this}}</td>
							{{/each}}
							<td class="text-right no-wrap">
								{{#if actionPreview}}
									<button class="btn btn-sm btn-outline-primary border-0 preview-button"
											data-target="{{document._id}}">
										<i class="fa fas fa-fw fa-eye"></i>
									</button>
								{{/if}}
								{{#if actionUpdate}}
									<button class="btn btn-sm btn-outline-primary border-0 edit-button"
											data-target="{{document._id}}">
										<i class="fa fas fa-fw fa-edit"></i>
									</button>
								{{/if}}
								{{#if actionRemove}}
									<button class="btn btn-sm btn-outline-danger border-0 remove-button"
											data-target="{{document._id}}">
										<i class="fa fas fa-fw fa-trash"></i>
									</button>
								{{/if}}
							</td>
						</tr>
					{{/each}}
				</table>
			</div>
		{{else}}
			<div class="card-body">
				<div class="jumbotron">
					<p>{{i18n "common.noDocuments"}}</p>
				</div>
			</div>
		{{/with}}
		{{#with previewTarget}}
			{{> preview doc=this.doc template=this.template onClosed=onClosed titleField=this.titleField }}
		{{/with}}
	{{/if}}
</template>